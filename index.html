<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">    
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>    
    <script src="/socket.io/socket.io.js" node=""></script>
    <title>ChatBot V.1</title>
</head>
<body>
    <div class="bg-dark">
        <div class="container-fluid px-4">
            <div class="bg-warning p-5">
                <h1 class='text-info m-3'>
                    Leave a message
                </h1>
                <input type="text" id="name" class="form-control m-3" placeholder="Name">  
                <textarea type="text" id="message" class="form-control  m-3" placeholder="Message here..."></textarea>
                <button id="send" class="btn btn-success  m-3" onClick="window.location.reload()">Send</button>
                <div class="big-secondary p-5 m-3">
                    <div id="messages">
    
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let socket = io( )
$(()=>{
    $("#send").click(()=>{
        // addMessages({name:"John", message:"Hello World!"})
        let message = {
            name:$("#name").val(),
            message:$("#message").val()
        }
        postMessages(message)
    })
    getMessages()
})
socket.on('message',addMessasge)

function addMessages(message){
    $("#messages").append(
        `<div class="bg-info p-3 m-3 text-light border rounded"><h4>${message.name}</h4> <p>${message.message}</p></div> `
        )
}

function getMessages(){
$.get('https://hsia-chatbot.herokuapp.com/messages',(data)=>{
    data.forEach(addMessages)
    
})
}

function postMessages(message){

    $.post('https://hsia-chatbot.herokuapp.com/messages',message)
    
}

    </script>
</body>
</html>